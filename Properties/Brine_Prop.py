import math

def BW(P, T):
    A1 = 0.9947 + ((5.8 * 10 ** -6) * T) + ((1.02 * 10 ** -6) * T ** 2)
    A2 = (-4.228 * 10 ** -6) + ((1.8376 * 10 ** -8) * T) + ((-6.77 * 10 ** -11) * T ** 2)
    A3 = (1.3 * 10 ** -10) + ((-1.3855 * 10 ** -12) * T) + ((4.285 * 10 ** -15) * T ** 2)
    BW = A1 + (A2 * P) + (A3 * P ** 2)
    
    return BW;


def BWSat(P, T):
    A1 = 0.9911 + ((6.35 * 10 ** -5) * T) + ((8.5 * 10 ** -7) * T ** 2)
    A2 = (-1.093 * 10 ** -6) + ((-3.497 * 10 ** -9) * T) + ((4.57 * 10 ** -12) * T ** 2)
    A3 = (-5 * 10 ** -11) + ((6.429 * 10 ** -13) * T) + ((-1.43 * 10 ** -15) * T ** 2)
    BWSat = A1 + (A2 * P) + (A3 * P ** 2)
    
    return BWSat;


def RSW(P, T, TDS):
    A = 2.12 + (3.45 * (10 ** -3) * T) - (3.59 * (10 ** -5) * T ** 2)
    B = 0.0107 - (5.26 * (10 ** -5) * T) + (1.48 * (10 ** -7) * T ** 2)
    C = (-8.75 * (10 ** -7)) + (3.9 * (10 ** -9) * T) - (1.02 * (10 ** -11) * T ** 2)
    Rswpure = A + (B * P) + (C * (P ** 2))
    SC = 1 - ((0.0753 - (0.000173 * T)) * TDS)
    RSW = Rswpure * SC / 1000
    
    return RSW;


def RhoW(TDS, BW):
    RhoW = (((TDS / 100) * 62.4) + 62.4) / BW
    
    return RhoW;


def MiuW(P:float, T:float, TDS:float, corr:str):
    if corr.lower() == 'beggs':
        MiuWBeggs = math.exp(1.003 - (1.479 * (10 ** -2) * T) + (1.982 * (10 ** -5) * T ** 2))
        return MiuWBeggs;
    elif corr.lower() == 'mcchain':
        S = TDS * 10 ** -4
        A = (-1.2166) + (2.63951 * (10 ** -2) * S) - (6.79461 * (10 ** -4) * S ** 2) - (5.47119 * (10 ** -5) * S ** 3) + (1.55586 * (10 ** -6) * S ** 4)
        Miu = (109.574 - (8.40564 * S) + (0.313314 * S ** 2) + (8.72213 * (10 ** -5) * (S ** 3))) * (T) ** A
        MiuWMcCain = (0.9994 + (4.0295 * (10 ** -5) * P) + (3.1062 * (10 ** -9) * P ** 2)) * Miu
        return MiuWMcCain;


def CW(P, T):
    C1 = 3.8546 - (0.000134 * P)
    C2 = -0.01052 + (4.77 * (10 ** -7) * P)
    C3 = (3.9267 * (10 ** -5)) - (8.8 * (10 ** -10) * P)
    CW = (C1 + (C2 * T) + (C3 * T ** 2)) * (10 ** -6)
    
    return CW;

def Water_Pbubble(temp):
    temp = (temp - 32) * (5 / 9)
    if temp >= 0 and temp <= 100:
        a = 8.07131; b = 1730.63; c = 233.426
    if temp > 100 and temp <= 374:
        a = 8.14019; b = 1810.94; c = 244.485

    pbubble = 10**(a - (b / (c + temp)))
    pbubble = pbubble / 51.715 
    
    return pbubble
